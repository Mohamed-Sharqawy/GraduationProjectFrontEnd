<div class="dashboard-container">
    <div class="dashboard-header">
        <div>
            <h1>My Properties</h1>
            <p style="color: #666; margin-top: 5px;">Manage your listings for sale or rent</p>
        </div>
        <button class="add-btn" (click)="addProperty()">
            <span style="font-size: 20px;">+</span> Add New Property
        </button>
    </div>

    @if (userProperties.length === 0) {
    <div style="text-align: center; padding: 50px; background: white; border-radius: 8px;">
        <p style="font-size: 18px; color: #666;">You haven't posted any properties yet.</p>
        <button class="add-btn" style="margin: 20px auto;" (click)="addProperty()">Create your first listing</button>
    </div>
    } @else {
    <div class="properties-grid">
        @for (prop of userProperties; track prop.id) {
        <div class="property-card">
            <div class="card-image">
                <img [src]="prop.mainImageUrl || 'https://placehold.co/600x400?text=No+Image'" [alt]="prop.title">
                <span
                    style="position: absolute; top: 10px; left: 10px; background: rgba(0,0,0,0.6); color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px;">{{prop.status}}</span>
            </div>
            <div class="card-content">
                <h3 class="card-title">{{prop.title}}</h3>
                <div class="card-price">{{prop.price | currency : prop.currency : 'symbol' : '1.0-0'}}</div>

                <div class="card-details">
                    <div class="detail-item">üõè {{prop.rooms}} Beds</div>
                    <div class="detail-item">üöø {{prop.bathrooms}} Baths</div>
                    <div class="detail-item">üìê {{prop.area}} m¬≤</div>
                </div>

                <div style="margin-top: auto; display: flex; align-items: center; color: #666; font-size: 13px;">
                    üìç {{prop.location}}
                </div>
            </div>
            <div class="card-actions">
                <button class="action-btn edit-btn" (click)="editProperty(prop.id)">‚úé Edit</button>
                <button class="action-btn delete-btn" (click)="deleteProperty(prop.id)">üóë Delete</button>
            </div>
        </div>
        }
    </div>
    }
</div>

<!-- Add/Edit Modal -->
@if (isFormVisible) {
<div class="modal-overlay" (click)="cancel()">
    <div class="modal-content" (click)="$event.stopPropagation()">
        <div class="modal-header">
            <h2>{{ isEditing ? 'Edit Property' : 'Add New Property' }}</h2>
            <button class="close-btn" (click)="cancel()">√ó</button>
        </div>

        <form (ngSubmit)="saveProperty()">
            <div class="form-group">
                <label>Property Title</label>
                <input type="text" class="form-control" [(ngModel)]="currentProperty.title" name="title"
                    placeholder="e.g., Luxury Apartment in Cairo" required>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Price (EGP)</label>
                    <input type="number" class="form-control" [(ngModel)]="currentProperty.price" name="price" required>
                </div>
                <div class="form-group">
                    <label>Location</label>
                    <input type="text" class="form-control" [(ngModel)]="currentProperty.location" name="location"
                        placeholder="City, Area" required>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Type</label>
                    <select class="form-control" [(ngModel)]="currentProperty.propertyType" name="propertyType">
                        <option value="Apartment">Apartment</option>
                        <option value="Villa">Villa</option>
                        <option value="Duplex">Duplex</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Status</label>
                    <select class="form-control" [(ngModel)]="currentProperty.status" name="status">
                        <option value="Ready">Ready</option>
                        <option value="Off-Plan">Off-Plan</option>
                    </select>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Bedrooms</label>
                    <input type="number" class="form-control" [(ngModel)]="currentProperty.rooms" name="rooms">
                </div>
                <div class="form-group">
                    <label>Bathrooms</label>
                    <input type="number" class="form-control" [(ngModel)]="currentProperty.bathrooms" name="bathrooms">
                </div>
                <div class="form-group">
                    <label>Area (m¬≤)</label>
                    <input type="number" class="form-control" [(ngModel)]="currentProperty.area" name="area">
                </div>
            </div>

            <div class="form-group">
                <label>Image URL</label>
                <input type="text" class="form-control" [(ngModel)]="currentProperty.mainImageUrl" name="mainImageUrl"
                    placeholder="https://example.com/image.jpg">
            </div>

            <div class="modal-footer">
                <button type="button" class="btn-cancel" (click)="cancel()">Cancel</button>
                <button type="submit" class="btn-save">Save Property</button>
            </div>
        </form>
    </div>
</div>
}